import { DEFAULT_CONFIG } from '../helpers/default-config';
import { isCharacter, isDigitGroupOptionObject, isPrettyFloatDecimalOptionObject, isPrettyFloatDigitGroupOptionObject } from '../type-predicates';
import { BASIC_UTIL } from './_basic.util';
const makeBoolean = BASIC_UTIL.makeBoolean;
const digitGroupDefaults = {
    integerPart: { ...DEFAULT_CONFIG.digitGroups },
    decimalPart: { ...DEFAULT_CONFIG.digitGroups },
    hasDigitGroups: false
};
const sanitizeDigitGroupDelimiter = params => {
    const delimiter = params.delimiter;
    if (delimiter && !isCharacter(delimiter)) {
        console.warn('[NgIndigit] Invalid Digit Group Delimiter! The default character will be used!');
        delete params.delimiter;
    }
    return params;
};
const digitGroupParamFromGenericOption = (option, preset) => {
    const params = { ...preset };
    ['integerPart', 'decimalPart']
        .forEach(part => Object.assign(params[part], sanitizeDigitGroupDelimiter(option), params[part]));
    return params;
};
const digitGroupParamFromPrettyFloatOption = (option, preset) => {
    const params = { ...preset };
    ['integerPart', 'decimalPart']
        .forEach(part => {
        const partOption = option[part];
        if (isDigitGroupOptionObject(partOption))
            params[part] = { ...params[part], ...sanitizeDigitGroupDelimiter(partOption) };
        else if (partOption === false)
            params[part] = { ...params[part], groupSize: 0 };
    });
    return params;
};
export const PRETTY_FLOAT_PARAM_UTIL = {
    decimal: options => {
        const decimalDefaults = DEFAULT_CONFIG.decimal;
        const defaults = { ...decimalDefaults, isDecimalAllowed: false };
        if (isPrettyFloatDecimalOptionObject(options)) {
            const point = options.floatPoint;
            if (point && !isCharacter(point)) {
                console.warn('[NgIndigit] Invalid Float Point! The default character will be used!');
                delete options.floatPoint;
            }
            return { ...defaults, ...options, isDecimalAllowed: options.isDecimalAllowed ?? (options.maxDigitCount !== 0) };
        }
        return { ...defaults, isDecimalAllowed: makeBoolean(options) };
    },
    digitGroup: (...options) => {
        if (!makeBoolean(options))
            return digitGroupDefaults;
        let params = { ...digitGroupDefaults };
        for (const option of options) {
            if (option == null)
                continue;
            if (isPrettyFloatDigitGroupOptionObject(option))
                params = digitGroupParamFromPrettyFloatOption(option, params);
            if (isDigitGroupOptionObject(option))
                params = digitGroupParamFromGenericOption(option, params);
            params.hasDigitGroups
                = option.hasDigitGroups ?? ((params.integerPart.groupSize > 0) || (params.decimalPart.groupSize > 0));
        }
        return params;
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiX3ByZXR0eS1mbG9hdC1wYXJhbS51dGlsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmctaW5kaWdpdC9zcmMvbGliL3V0aWxzL19wcmV0dHktZmxvYXQtcGFyYW0udXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDM0QsT0FBTyxFQUFFLFdBQVcsRUFBRSx3QkFBd0IsRUFBRSxnQ0FBZ0MsRUFBRSxtQ0FBbUMsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ2xKLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFHM0MsTUFBTSxXQUFXLEdBQUcsVUFBVSxDQUFDLFdBQVcsQ0FBQztBQUMzQyxNQUFNLGtCQUFrQixHQUFnQztJQUN0RCxXQUFXLEVBQUUsRUFBRSxHQUFHLGNBQWMsQ0FBQyxXQUFXLEVBQUU7SUFDOUMsV0FBVyxFQUFFLEVBQUUsR0FBRyxjQUFjLENBQUMsV0FBVyxFQUFFO0lBQzlDLGNBQWMsRUFBRSxLQUFLO0NBQ3RCLENBQUM7QUFFRixNQUFNLDJCQUEyQixHQUFxRSxNQUFNLENBQUMsRUFBRTtJQUM3RyxNQUFNLFNBQVMsR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDO0lBQ25DLElBQUksU0FBUyxJQUFJLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxFQUFFO1FBQ3hDLE9BQU8sQ0FBQyxJQUFJLENBQUMsZ0ZBQWdGLENBQUMsQ0FBQztRQUMvRixPQUFPLE1BQU0sQ0FBQyxTQUFTLENBQUM7S0FDekI7SUFDRCxPQUFPLE1BQU0sQ0FBQztBQUNoQixDQUFDLENBQUM7QUFFRixNQUFNLGdDQUFnQyxHQUVsQyxDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsRUFBRTtJQUNyQixNQUFNLE1BQU0sR0FBRyxFQUFFLEdBQUcsTUFBTSxFQUFFLENBQUM7SUFDNUIsQ0FBQyxhQUFhLEVBQUUsYUFB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SSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDekc7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0NBRUYsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERFRkFVTFRfQ09ORklHIH0gZnJvbSAnLi4vaGVscGVycy9kZWZhdWx0LWNvbmZpZyc7XHJcbmltcG9ydCB7IGlzQ2hhcmFjdGVyLCBpc0RpZ2l0R3JvdXBPcHRpb25PYmplY3QsIGlzUHJldHR5RmxvYXREZWNpbWFsT3B0aW9uT2JqZWN0LCBpc1ByZXR0eUZsb2F0RGlnaXRHcm91cE9wdGlvbk9iamVjdCB9IGZyb20gJy4uL3R5cGUtcHJlZGljYXRlcyc7XHJcbmltcG9ydCB7IEJBU0lDX1VUSUwgfSBmcm9tICcuL19iYXNpYy51dGlsJztcclxuaW1wb3J0IHsgSURpZ2l0R3JvdXBQYXJhbSwgSVByZXR0eUZsb2F0RGVjaW1hbFBhcmFtLCBJUHJldHR5RmxvYXREaWdpdEdyb3VwT3B0aW9uLCBJUHJldHR5RmxvYXREaWdpdEdyb3VwUGFyYW0gfSBmcm9tICcuLi9pbnRlcmZhY2VzJztcclxuXHJcbmNvbnN0IG1ha2VCb29sZWFuID0gQkFTSUNfVVRJTC5tYWtlQm9vbGVhbjtcclxuY29uc3QgZGlnaXRHcm91cERlZmF1bHRzOiBJUHJldHR5RmxvYXREaWdpdEdyb3VwUGFyYW0gPSB7XHJcbiAgaW50ZWdlclBhcnQ6IHsgLi4uREVGQVVMVF9DT05GSUcuZGlnaXRHcm91cHMgfSxcclxuICBkZWNpbWFsUGFydDogeyAuLi5ERUZBVUxUX0NPTkZJRy5kaWdpdEdyb3VwcyB9LFxyXG4gIGhhc0RpZ2l0R3JvdXBzOiBmYWxzZVxyXG59O1xyXG5cclxuY29uc3Qgc2FuaXRpemVEaWdpdEdyb3VwRGVsaW1pdGVyOiAocGFyYW1zOiBQYXJ0aWFsPElEaWdpdEdyb3VwUGFyYW0+KSA9PiBQYXJ0aWFsPElEaWdpdEdyb3VwUGFyYW0+ID0gcGFyYW1zID0+IHtcclxuICBjb25zdCBkZWxpbWl0ZXIgPSBwYXJhbXMuZGVsaW1pdGVyO1xyXG4gIGlmIChkZWxpbWl0ZXIgJiYgIWlzQ2hhcmFjdGVyKGRlbGltaXRlcikpIHtcclxuICAgIGNvbnNvbGUud2FybignW05nSW5kaWdpdF0gSW52YWxpZCBEaWdpdCBHcm91cCBEZWxpbWl0ZXIhIFRoZSBkZWZhdWx0IGNoYXJhY3RlciB3aWxsIGJlIHVzZWQhJyk7XHJcbiAgICBkZWxldGUgcGFyYW1zLmRlbGltaXRlcjtcclxuICB9XHJcbiAgcmV0dXJuIHBhcmFtcztcclxufTtcclxuXHJcbmNvbnN0IGRpZ2l0R3JvdXBQYXJhbUZyb21HZW5lcmljT3B0aW9uOlxyXG4gIChvcHRpb246IFBhcnRpYWw8SURpZ2l0R3JvdXBQYXJhbT4sIHByZXNldDogSVByZXR0eUZsb2F0RGlnaXRHcm91cFBhcmFtKSA9PiBJUHJldHR5RmxvYXREaWdpdEdyb3VwUGFyYW1cclxuICA9IChvcHRpb24sIHByZXNldCkgPT4ge1xyXG4gIGNvbnN0IHBhcmFtcyA9IHsgLi4ucHJlc2V0IH07XHJcbiAgKFsnaW50ZWdlclBhcnQnLCAnZGVjaW1hbFBhcnQnXSBhcyAoa2V5b2YgT21pdDxJUHJldHR5RmxvYXREaWdpdEdyb3VwUGFyYW0sICdoYXNEaWdpdEdyb3Vwcyc+KVtdKVxyXG4gICAgLmZvckVhY2gocGFydCA9PiBPYmplY3QuYXNzaWduKHBhcmFtc1twYXJ0XSwgc2FuaXRpemVEaWdpdEdyb3VwRGVsaW1pdGVyKG9wdGlvbiksIHBhcmFtc1twYXJ0XSkpO1xyXG4gIHJldHVybiBwYXJhbXM7XHJcbn07XHJcblxyXG5jb25zdCBkaWdpdEdyb3VwUGFyYW1Gcm9tUHJldHR5RmxvYXRPcHRpb246XHJcbiAgKG9wdGlvbjogSVByZXR0eUZsb2F0RGlnaXRHcm91cE9wdGlvbiwgcHJlc2V0OiBJUHJldHR5RmxvYXREaWdpdEdyb3VwUGFyYW0pID0+IElQcmV0dHlGbG9hdERpZ2l0R3JvdXBQYXJhbVxyXG4gID0gKG9wdGlvbiwgcHJlc2V0KSA9PiB7XHJcbiAgY29uc3QgcGFyYW1zOiBJUHJldHR5RmxvYXREaWdpdEdyb3VwUGFyYW0gPSB7IC4uLnByZXNldCB9O1xyXG4gIChbJ2ludGVnZXJQYXJ0JywgJ2RlY2ltYWxQYXJ0J10gYXMgKGtleW9mIE9taXQ8SVByZXR0eUZsb2F0RGlnaXRHcm91cFBhcmFtLCAnaGFzRGlnaXRHcm91cHMnPilbXSlcclxuICAgIC5mb3JFYWNoKHBhcnQgPT4ge1xyXG4gICAgICBjb25zdCBwYXJ0T3B0aW9uID0gb3B0aW9uW3BhcnRdO1xyXG4gICAgICBpZiAoaXNEaWdpdEdyb3VwT3B0aW9uT2JqZWN0KHBhcnRPcHRpb24pKVxyXG4gICAgICAgIHBhcmFtc1twYXJ0XSA9IHsgLi4ucGFyYW1zW3BhcnRdLCAuLi5zYW5pdGl6ZURpZ2l0R3JvdXBEZWxpbWl0ZXIocGFydE9wdGlvbikgfTtcclxuICAgICAgZWxzZSBpZiAocGFydE9wdGlvbiA9PT0gZmFsc2UpXHJcbiAgICAgICAgcGFyYW1zW3BhcnRdID0geyAuLi5wYXJhbXNbcGFydF0sIGdyb3VwU2l6ZTogMCB9O1xyXG4gICAgfSk7XHJcbiAgcmV0dXJuIHBhcmFtcztcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBQUkVUVFlfRkxPQVRfUEFSQU1fVVRJTDoge1xyXG4gIGRlY2ltYWw6IChvcHRpb246IGFueSkgPT4gSVByZXR0eUZsb2F0RGVjaW1hbFBhcmFtO1xyXG4gIGRpZ2l0R3JvdXA6ICguLi5vcHRpb246IGFueVtdKSA9PiBJUHJldHR5RmxvYXREaWdpdEdyb3VwUGFyYW07XHJcbn0gPSB7XHJcblxyXG4gIGRlY2ltYWw6IG9wdGlvbnMgPT4ge1xyXG4gICAgY29uc3QgZGVjaW1hbERlZmF1bHRzID0gREVGQVVMVF9DT05GSUcuZGVjaW1hbDtcclxuICAgIGNvbnN0IGRlZmF1bHRzID0geyAuLi5kZWNpbWFsRGVmYXVsdHMsIGlzRGVjaW1hbEFsbG93ZWQ6IGZhbHNlIH0gYXMgSVByZXR0eUZsb2F0RGVjaW1hbFBhcmFtO1xyXG4gICAgaWYgKGlzUHJldHR5RmxvYXREZWNpbWFsT3B0aW9uT2JqZWN0KG9wdGlvbnMpKSB7XHJcbiAgICAgIGNvbnN0IHBvaW50ID0gb3B0aW9ucy5mbG9hdFBvaW50O1xyXG4gICAgICBpZiAocG9pbnQgJiYgIWlzQ2hhcmFjdGVyKHBvaW50KSkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybignW05nSW5kaWdpdF0gSW52YWxpZCBGbG9hdCBQb2ludCEgVGhlIGRlZmF1bHQgY2hhcmFjdGVyIHdpbGwgYmUgdXNlZCEnKTtcclxuICAgICAgICBkZWxldGUgb3B0aW9ucy5mbG9hdFBvaW50O1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB7IC4uLmRlZmF1bHRzLCAuLi5vcHRpb25zLCBpc0RlY2ltYWxBbGxvd2VkOiBvcHRpb25zLmlzRGVjaW1hbEFsbG93ZWQgPz8gKG9wdGlvbnMubWF4RGlnaXRDb3VudCAhPT0gMCkgfTtcclxuICAgIH1cclxuICAgIHJldHVybiB7IC4uLmRlZmF1bHRzLCBpc0RlY2ltYWxBbGxvd2VkOiBtYWtlQm9vbGVhbihvcHRpb25zKSB9O1xyXG4gIH0sXHJcblxyXG4gIGRpZ2l0R3JvdXA6ICguLi5vcHRpb25zKSA9PiB7XHJcbiAgICBpZiAoIW1ha2VCb29sZWFuKG9wdGlvbnMpKVxyXG4gICAgICByZXR1cm4gZGlnaXRHcm91cERlZmF1bHRzO1xyXG4gICAgbGV0IHBhcmFtczogSVByZXR0eUZsb2F0RGlnaXRHcm91cFBhcmFtID0geyAuLi5kaWdpdEdyb3VwRGVmYXVsdHMgfTtcclxuICAgIGZvciAoY29uc3Qgb3B0aW9uIG9mIG9wdGlvbnMpIHtcclxuICAgICAgaWYgKG9wdGlvbiA9PSBudWxsKVxyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICBpZiAoaXNQcmV0dHlGbG9hdERpZ2l0R3JvdXBPcHRpb25PYmplY3Qob3B0aW9uKSlcclxuICAgICAgICBwYXJhbXMgPSBkaWdpdEdyb3VwUGFyYW1Gcm9tUHJldHR5RmxvYXRPcHRpb24ob3B0aW9uLCBwYXJhbXMpO1xyXG4gICAgICBpZiAoaXNEaWdpdEdyb3VwT3B0aW9uT2JqZWN0KG9wdGlvbikpXHJcbiAgICAgICAgcGFyYW1zID0gZGlnaXRHcm91cFBhcmFtRnJvbUdlbmVyaWNPcHRpb24ob3B0aW9uLCBwYXJhbXMpO1xyXG4gICAgICBwYXJhbXMuaGFzRGlnaXRHcm91cHNcclxuICAgICAgICA9IG9wdGlvbi5oYXNEaWdpdEdyb3VwcyA/PyAoKHBhcmFtcy5pbnRlZ2VyUGFydC5ncm91cFNpemUgPiAwKSB8fCAocGFyYW1zLmRlY2ltYWxQYXJ0Lmdyb3VwU2l6ZSA+IDApKTtcclxuICAgIH1cclxuICAgIHJldHVybiBwYXJhbXM7XHJcbiAgfVxyXG5cclxufTtcclxuIl19